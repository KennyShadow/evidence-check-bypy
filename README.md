# æ”¶å…¥è¯æ®ç®¡ç†ç¨‹åº

<div align="center">

![Python](https://img.shields.io/badge/python-v3.7+-blue.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![GUI](https://img.shields.io/badge/GUI-CustomTkinter-orange.svg)
![Data](https://img.shields.io/badge/data-Pandas-red.svg)
![Excel](https://img.shields.io/badge/excel-OpenPyXL-green.svg)
![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)

**æ”¶å…¥è¯æ®ç®¡ç†ç³»ç»Ÿ** - ä¸“ä¸šçš„è´¢åŠ¡æ•°æ®ç®¡ç†ä¸è¯æ®å½’æ¡£è§£å†³æ–¹æ¡ˆ

[ğŸ¯ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹) â€¢
[âœ¨ åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§) â€¢
[ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢
[ğŸ“– ç”¨æˆ·æ‰‹å†Œ](#-ç”¨æˆ·æ‰‹å†Œ) â€¢
[ğŸ›  å¼€å‘æ–‡æ¡£](#-å¼€å‘æ–‡æ¡£) â€¢
[ğŸ”§ éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—) â€¢
[â“ å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)

</div>

---

## ğŸ¯ é¡¹ç›®ç®€ä»‹

å¼€å‘è¿™ä¸ªç¨‹åºæ˜¯å› ä¸ºä»Šå¹´å¹´å®¡ä¸­é’ˆå¯¹æŒ‰é¡¹ç›®ç»“ç®—æ”¶å…¥çš„è¡Œä¸šï¼ˆä¸»è¦æ˜¯è½¯ä»¶è¡Œä¸šï¼‰ï¼Œéœ€è¦æ•´ç†è¾ƒå¤šçš„æ”¶å…¥ç»“ç®—è¯æ®ï¼Œåœ¨è¯æ®ç®¡ç†ä¸ŠèŠ±è´¹äº†è¾ƒå¤šæ—¶é—´ã€‚

å› æ­¤å¼€å‘äº†è¿™ä¸ªç¨‹åºï¼Œæ–¹ä¾¿ç®¡ç†ç¨‹åºæ”¶å…¥è¯æ®ã€‚

å£°æ˜ï¼šæœ¬ç¨‹åºä½¿ç”¨Cursorè¿›è¡Œå¼€å‘

### ğŸ† ç‰¹å¾

- **ğŸ”’ æ•°æ®å®‰å…¨**ï¼š100% æœ¬åœ°å­˜å‚¨ï¼Œç¬¦åˆæ•°æ®ä¿æŠ¤æ³•è§„ï¼Œé›¶æ•°æ®æ³„éœ²é£é™©
- **ğŸ“Š æ™ºèƒ½åˆ†æ**ï¼šè‡ªåŠ¨å·®å¼‚è®¡ç®—ã€è¶‹åŠ¿åˆ†æå’Œæ•°æ®å¯è§†åŒ–

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š ä¸“ä¸šæ•°æ®ç®¡ç†

#### ğŸ”„ æ™ºèƒ½æ•°æ®å¯¼å…¥

- **å¤šæ ¼å¼æ”¯æŒ**ï¼š`.xlsx`ã€`.xls`ã€`.csv` æ ¼å¼æ— ç¼å¯¼å…¥
- **æ•°æ®é¢„è§ˆ**ï¼šå¯¼å…¥å‰å¯é¢„è§ˆæ•°æ®ç»“æ„å’Œå†…å®¹
- **å¢é‡å¯¼å…¥**ï¼šæ”¯æŒå¢é‡æ•°æ®æ›´æ–°ï¼Œé¿å…é‡å¤å¯¼å…¥
- **é”™è¯¯æ£€æµ‹**ï¼šå®æ—¶æ•°æ®éªŒè¯å’Œé”™è¯¯æç¤º
- **å¤§æ–‡ä»¶å¤„ç†**ï¼šæ”¯æŒç™¾ä¸‡çº§æ•°æ®é‡çš„é«˜æ•ˆå¤„ç†

#### ğŸ—ƒï¸ é¡¹ç›®ç®¡ç†

- **å¤šç§Ÿæˆ·æ¶æ„**ï¼šå®Œå…¨éš”ç¦»çš„å¤šé¡¹ç›®ç¯å¢ƒ
- **é¡¹ç›®æ¨¡æ¿**ï¼šé¢„å®šä¹‰çš„è¡Œä¸šæ ‡å‡†æ¨¡æ¿

#### âœï¸ é«˜çº§æ•°æ®ç¼–è¾‘

- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒå¤šè¡Œæ•°æ®çš„æ‰¹é‡ç¼–è¾‘å’Œæ›´æ–°
- **æ•°æ®éªŒè¯**ï¼šå®æ—¶çš„æ•°æ®å®Œæ•´æ€§å’Œä¸šåŠ¡è§„åˆ™æ£€æŸ¥
- **å˜æ›´è¿½è¸ª**ï¼šè¯¦ç»†è®°å½•æ¯æ¬¡æ•°æ®ä¿®æ”¹çš„å†å²

### ğŸ” ä¸“ä¸šæ•°æ®ç­›é€‰ä¸æœç´¢

#### ğŸ¯ å¤šç»´åº¦ç­›é€‰å¼•æ“

- **æ™ºèƒ½ç­›é€‰å™¨**ï¼šæ”¯æŒ20+ç­›é€‰ç»´åº¦ï¼ŒåŒ…æ‹¬åˆåŒçŠ¶æ€ã€é‡‘é¢èŒƒå›´ã€æ—¶é—´å‘¨æœŸç­‰
- **å¤åˆæ¡ä»¶**ï¼šæ”¯æŒ AND/OR é€»è¾‘çš„å¤æ‚ç­›é€‰ç»„åˆ
- **ä¿å­˜ç­›é€‰**ï¼šå¸¸ç”¨ç­›é€‰æ¡ä»¶å¯ä¿å­˜ä¸ºæ¨¡æ¿ï¼Œä¸€é”®è°ƒç”¨
- **å¿«é€Ÿç­›é€‰**ï¼šé¢„è®¾çš„å¸¸ç”¨ç­›é€‰åœºæ™¯ï¼Œå¦‚"æœ‰å·®å¼‚è®°å½•"ã€"ç¼ºå¤±é™„ä»¶"ç­‰
- **åŠ¨æ€ç­›é€‰**ï¼šç­›é€‰ç»“æœå®æ—¶æ›´æ–°ï¼Œæ”¯æŒç­›é€‰æ¡ä»¶çš„åŠ¨æ€è°ƒæ•´

#### ğŸ” é«˜çº§æœç´¢åŠŸèƒ½

- **å…¨æ–‡æœç´¢**ï¼šæ”¯æŒå¯¹æ‰€æœ‰æ–‡æœ¬å­—æ®µçš„å…¨æ–‡æ£€ç´¢
- **æ¨¡ç³ŠåŒ¹é…**ï¼šæ™ºèƒ½çš„è¿‘ä¼¼åŒ¹é…ç®—æ³•ï¼Œå®¹é”™æœç´¢
- **æœç´¢å†å²**ï¼šä¿å­˜æœç´¢å†å²ï¼Œå¿«é€Ÿé‡å¤æœç´¢
- **æœç´¢å»ºè®®**ï¼šåŸºäºå†å²æ•°æ®çš„æ™ºèƒ½æœç´¢å»ºè®®

### ğŸ“ é™„ä»¶ç®¡ç†

#### ğŸ“¤ æ™ºèƒ½é™„ä»¶å¤„ç†

- **æ‹–æ‹½ä¸Šä¼ **ï¼šç°ä»£åŒ–çš„æ‹–æ‹½ç•Œé¢ï¼Œæ”¯æŒæ‰¹é‡ä¸Šä¼ 
- **æ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒ30+æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬PDFã€Officeã€å›¾ç‰‡ã€é‚®ä»¶ç­‰
- **è‡ªåŠ¨åˆ†ç±»**ï¼šæ ¹æ®æ–‡ä»¶ç±»å‹è‡ªåŠ¨åˆ†ç±»å’Œæ ‡è®°
- **æ–‡ä»¶é¢„è§ˆ**ï¼šå†…ç½®é¢„è§ˆåŠŸèƒ½ï¼Œæ”¯æŒå¸¸è§æ ¼å¼çš„å¿«é€Ÿé¢„è§ˆ
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šåŒä¸€é™„ä»¶çš„å¤šç‰ˆæœ¬ç®¡ç†
- **å‹ç¼©å­˜å‚¨**ï¼šè‡ªåŠ¨å‹ç¼©å­˜å‚¨ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´

#### ğŸ—‚ï¸ ä¸“ä¸šæ–‡æ¡£ç®¡ç†

- **è‡ªåŠ¨å½’æ¡£**ï¼šæŒ‰åˆåŒå·è‡ªåŠ¨åˆ›å»ºå’Œç»„ç»‡æ–‡ä»¶å¤¹ç»“æ„
- **æ–‡ä»¶ç´¢å¼•**ï¼šå…¨æ–‡ç´¢å¼•æ”¯æŒï¼Œå¯æœç´¢é™„ä»¶å†…å®¹
- **è®¿é—®æ§åˆ¶**ï¼šæ–‡ä»¶çº§åˆ«çš„è®¿é—®æƒé™æ§åˆ¶
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒé™„ä»¶çš„æ‰¹é‡é‡å‘½åã€ç§»åŠ¨ã€åˆ é™¤
- **å¤–éƒ¨é“¾æ¥**ï¼šæ”¯æŒå¤–éƒ¨æ–‡ä»¶çš„é“¾æ¥ç®¡ç†

### ğŸ“ˆ ä¸“ä¸šè´¢åŠ¡åˆ†æ

#### ğŸ§® æ™ºèƒ½å·®å¼‚åˆ†æ

- **è‡ªåŠ¨è®¡ç®—å¼•æ“**ï¼šå®æ—¶è®¡ç®—è´¦é¢æ”¶å…¥ä¸é™„ä»¶æ”¶å…¥çš„å·®å¼‚
- **å·®å¼‚åˆ†ç±»**ï¼šæŒ‰å·®å¼‚ç±»å‹ã€é‡‘é¢èŒƒå›´è‡ªåŠ¨åˆ†ç±»
- **è¶‹åŠ¿åˆ†æ**ï¼šå·®å¼‚è¶‹åŠ¿å›¾è¡¨å’Œç»Ÿè®¡åˆ†æ
- **å¼‚å¸¸æ£€æµ‹**ï¼šåŸºäºç»Ÿè®¡å­¦çš„å¼‚å¸¸æ•°æ®è‡ªåŠ¨è¯†åˆ«
- **å·®å¼‚æŠ¥å‘Š**ï¼šä¸“ä¸šçš„å·®å¼‚åˆ†ææŠ¥å‘Šç”Ÿæˆ

#### ğŸ“Š é«˜çº§ç»Ÿè®¡åˆ†æ

- **å®æ—¶ä»ªè¡¨æ¿**ï¼šå…³é”®æŒ‡æ ‡çš„å®æ—¶ç›‘æ§é¢æ¿
- **å¤šç»´åº¦åˆ†æ**ï¼šæŒ‰å®¢æˆ·ã€æ—¶é—´ã€äº§å“çº¿ç­‰ç»´åº¦çš„æ·±åº¦åˆ†æ
- **æ•°æ®é€è§†**ï¼šçµæ´»çš„æ•°æ®é€è§†è¡¨åŠŸèƒ½
- **å¯è§†åŒ–å›¾è¡¨**ï¼š20+ç§ä¸“ä¸šè´¢åŠ¡å›¾è¡¨ç±»å‹
- **é¢„æµ‹æ¨¡å‹**ï¼šåŸºäºå†å²æ•°æ®çš„æ”¶å…¥é¢„æµ‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### âš™ï¸ ç¯å¢ƒå‡†å¤‡

#### 1. Python ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python --version
# åº”æ˜¾ç¤º: Python 3.7.x æˆ–æ›´é«˜ç‰ˆæœ¬

# æ£€æŸ¥pipç‰ˆæœ¬
pip --version
# å»ºè®®å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬
python -m pip install --upgrade pip
```

#### 2. Git å·¥å…· (å¯é€‰)

å¦‚æœä½¿ç”¨Gitå…‹éš†ï¼Œè¯·ç¡®ä¿å·²å®‰è£… [Git for Windows](https://git-scm.com/download/win)

### ğŸ“¦ å®‰è£…æ­¥éª¤

#### æ–¹å¼ä¸€ï¼šGit å…‹éš† (æ¨è)

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/your-username/income-evidence-manager.git
cd income-evidence-manager

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (å¼ºçƒˆæ¨è)
python -m venv .venv
.venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. è¿è¡Œç¨‹åº
python main.py
```

#### æ–¹å¼äºŒï¼šç›´æ¥ä¸‹è½½

```bash
# 1. ä¸‹è½½ZIPæ–‡ä»¶å¹¶è§£å‹åˆ°ç›®æ ‡ç›®å½•
# 2. æ‰“å¼€PowerShellæˆ–å‘½ä»¤æç¤ºç¬¦ï¼Œè¿›å…¥è§£å‹ç›®å½•
cd path\to\income-evidence-manager

# 3. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
.venv\Scripts\activate

# 4. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 5. è¿è¡Œç¨‹åº
python main.py
```

### ğŸ¯ é¦–æ¬¡ä½¿ç”¨æŒ‡å—

#### 1. å¯åŠ¨åº”ç”¨ç¨‹åº

```bash
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
.venv\Scripts\activate

# å¯åŠ¨ç¨‹åº
python main.py
```

#### 2. åˆ›å»ºé¦–ä¸ªé¡¹ç›®

1. **é¡¹ç›®é€‰æ‹©å™¨**ï¼šç¨‹åºå¯åŠ¨åæ˜¾ç¤ºé¡¹ç›®ç®¡ç†ç•Œé¢
2. **æ–°å»ºé¡¹ç›®**ï¼šç‚¹å‡»"åˆ›å»ºæ–°é¡¹ç›®"æŒ‰é’®
3. **é¡¹ç›®ä¿¡æ¯**ï¼š
   - é¡¹ç›®åç§°ï¼šä¾‹å¦‚"Aå…¬å¸2024å¹´åº¦å¹´æŠ¥å®¡è®¡"
   - é¡¹ç›®æè¿°ï¼šè¯¦ç»†æè¿°é¡¹ç›®ç”¨é€” (å¯é€‰)
   - å­˜å‚¨ä½ç½®ï¼šé€‰æ‹©é¡¹ç›®æ•°æ®å­˜å‚¨ä½ç½®

#### 3. åŸºç¡€é…ç½®

1. **é™„ä»¶å­˜å‚¨è·¯å¾„**ï¼šè®¾ç½®é™„ä»¶æ–‡ä»¶çš„å­˜å‚¨æ ¹ç›®å½•
2. **å¯¼å…¥è®¾ç½®**ï¼šé…ç½®Excelå¯¼å…¥çš„é»˜è®¤å‚æ•°
3. **æ˜¾ç¤ºé€‰é¡¹**ï¼šè°ƒæ•´ç•Œé¢ä¸»é¢˜å’Œæ˜¾ç¤ºåå¥½

#### 4. å¯¼å…¥é¦–æ‰¹æ•°æ®

1. **å‡†å¤‡Excelæ–‡ä»¶**ï¼šç¡®ä¿åŒ…å«åˆåŒå·ã€å®¢æˆ·åã€æ”¶å…¥é‡‘é¢ç­‰å¿…è¦åˆ—
2. **å¯¼å…¥æ•°æ®**ï¼šç‚¹å‡»"å¯¼å…¥Excel"ï¼Œé€‰æ‹©æ–‡ä»¶å’Œå·¥ä½œè¡¨
3. **éªŒè¯æ•°æ®**ï¼šæ£€æŸ¥å¯¼å…¥ç»“æœï¼Œç¡®è®¤æ•°æ®æ­£ç¡®æ€§

### ğŸ”§ ç¯å¢ƒéªŒè¯

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯å®‰è£…ï¼š

```bash
# æ£€æŸ¥æ ¸å¿ƒä¾èµ–
python -c "import customtkinter; print('CustomTkinter:', customtkinter.__version__)"
python -c "import pandas; print('Pandas:', pandas.__version__)"
python -c "import openpyxl; print('OpenPyXL:', openpyxl.__version__)"

# è¿è¡Œç³»ç»Ÿæ£€æŸ¥ (å¯é€‰)
python -c "from src.config import check_system; check_system()"
```

## ğŸ“– ç”¨æˆ·æ‰‹å†Œ

### é¡¹ç›®ç®¡ç†

#### åˆ›å»ºæ–°é¡¹ç›®

- åœ¨é¡¹ç›®å¯åŠ¨å™¨ä¸­ç‚¹å‡»"æ–°å»ºé¡¹ç›®"
- è¾“å…¥é¡¹ç›®åç§°ï¼ˆå¿…å¡«ï¼‰å’Œæè¿°ï¼ˆå¯é€‰ï¼‰
- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé¡¹ç›®ç›®å½•å’Œé…ç½®æ–‡ä»¶

#### åˆ‡æ¢é¡¹ç›®

- åœ¨é¡¹ç›®å¯åŠ¨å™¨ä¸­é€‰æ‹©å·²æœ‰é¡¹ç›®
- åŒå‡»é¡¹ç›®åç§°æˆ–ç‚¹å‡»"æ‰“å¼€é¡¹ç›®"

### æ•°æ®å¯¼å…¥

#### Excelæ–‡ä»¶å¯¼å…¥

1. å‡†å¤‡Excelæ–‡ä»¶ï¼Œç¡®ä¿åŒ…å«ä»¥ä¸‹å¿…è¦åˆ—ï¼š

   - åˆåŒå·ï¼ˆå¿…é¡»å”¯ä¸€ï¼‰
   - å®¢æˆ·åç§°
   - æœ¬å¹´ç¡®è®¤çš„æ”¶å…¥
2. ç‚¹å‡»"å¯¼å…¥Excel"æŒ‰é’®
3. é€‰æ‹©Excelæ–‡ä»¶å’Œç›®æ ‡å·¥ä½œè¡¨
4. ç¡®è®¤åˆ—æ˜ å°„å…³ç³»
5. ç‚¹å‡»"å¯¼å…¥"å®Œæˆæ•°æ®å¯¼å…¥

#### æ•°æ®éªŒè¯è§„åˆ™

- åˆåŒå·ä¸èƒ½ä¸ºç©ºä¸”å¿…é¡»å”¯ä¸€
- å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º
- æ”¶å…¥é‡‘é¢å¿…é¡»ä¸ºæœ‰æ•ˆæ•°å­—
- é‡å¤åˆåŒå·ä¼šæç¤ºå¤„ç†æ–¹å¼

### æ•°æ®æ“ä½œ

#### æ·»åŠ è®°å½•

- ç‚¹å‡»"æ·»åŠ è®°å½•"æŒ‰é’®
- å¡«å†™å¿…è¦ä¿¡æ¯å¹¶ä¿å­˜
- æ–°å¢è®°å½•ä¼šè‡ªåŠ¨æ ‡è®°

#### ç¼–è¾‘è®°å½•

- åŒå‡»è¡¨æ ¼è¡Œæˆ–ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®
- ä¿®æ”¹ä¿¡æ¯åä¿å­˜
- æ”¯æŒæ‰¹é‡ç¼–è¾‘æ“ä½œ

#### åˆ é™¤è®°å½•

- é€‰æ‹©è¦åˆ é™¤çš„è®°å½•
- ç‚¹å‡»"åˆ é™¤"æŒ‰é’®
- ç¡®è®¤åˆ é™¤æ“ä½œ

### é™„ä»¶ç®¡ç†

#### ä¸Šä¼ é™„ä»¶

1. é€‰æ‹©ç›®æ ‡è®°å½•
2. ç‚¹å‡»"ç®¡ç†é™„ä»¶"æŒ‰é’®
3. ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä¸Šä¼ ï¼š
   - ç‚¹å‡»"æ·»åŠ é™„ä»¶"æŒ‰é’®é€‰æ‹©æ–‡ä»¶
   - ç›´æ¥æ‹–æ‹½æ–‡ä»¶åˆ°é™„ä»¶åˆ—è¡¨

#### é™„ä»¶æ“ä½œ

- **æŸ¥çœ‹é™„ä»¶**ï¼šåŒå‡»é™„ä»¶åç§°
- **é‡å‘½å**ï¼šå³é”®é€‰æ‹©é‡å‘½å
- **åˆ é™¤é™„ä»¶**ï¼šé€‰æ‹©é™„ä»¶åç‚¹å‡»åˆ é™¤
- **æ‰“å¼€æ–‡ä»¶å¤¹**ï¼šå¿«é€Ÿè®¿é—®é™„ä»¶å­˜å‚¨ä½ç½®

### æ•°æ®ç­›é€‰

#### åŸºç¡€ç­›é€‰

- ä½¿ç”¨é¡¶éƒ¨ç­›é€‰å™¨è®¾ç½®æ¡ä»¶
- æ”¯æŒåˆåŒå·ã€å®¢æˆ·åç§°æ¨¡ç³Šæœç´¢
- æŒ‰å·®å¼‚çŠ¶æ€ã€é™„ä»¶çŠ¶æ€ç­›é€‰

#### é«˜çº§ç­›é€‰

- ç»„åˆå¤šä¸ªç­›é€‰æ¡ä»¶
- è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´
- ä¿å­˜å’Œæ¢å¤ç­›é€‰è®¾ç½®

### æ•°æ®åˆ†æ

#### å·®å¼‚åˆ†æ

- è¾“å…¥"é™„ä»¶ç¡®è®¤çš„æ”¶å…¥"
- ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—å·®å¼‚é‡‘é¢
- æ·»åŠ å·®å¼‚åŸå› å¤‡æ³¨

#### ç»Ÿè®¡ä¿¡æ¯

- å·¦ä¾§é¢æ¿æ˜¾ç¤ºå®æ—¶ç»Ÿè®¡
- æ€»è®°å½•æ•°ã€å·®å¼‚ç»Ÿè®¡
- é™„ä»¶å…³è”çŠ¶æ€ç»Ÿè®¡

### æ•°æ®å¯¼å‡º

#### å¯¼å‡ºExcel

1. è®¾ç½®ç­›é€‰æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
2. ç‚¹å‡»"å¯¼å‡ºExcel"æŒ‰é’®
3. é€‰æ‹©å¯¼å‡ºè·¯å¾„å’Œæ–‡ä»¶å
4. ç¡®è®¤å¯¼å‡ºè®¾ç½®

## ğŸ›  å¼€å‘æ–‡æ¡£

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

æ”¶å…¥è¯æ®ç®¡ç†ç¨‹åºé‡‡ç”¨**åˆ†å±‚æ¶æ„è®¾è®¡**ï¼Œç¡®ä¿ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¡¨ç¤ºå±‚ (Presentation Layer)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ä¸»ç•Œé¢æ¨¡å—     â”‚  â”‚   å¯¹è¯æ¡†æ¨¡å—     â”‚  â”‚   ç»„ä»¶æ¨¡å—       â”‚ â”‚
â”‚  â”‚  main_window.py â”‚  â”‚ record_dialog.pyâ”‚  â”‚ filter_widget.pyâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡é€»è¾‘å±‚ (Business Layer)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æ•°æ®å¤„ç†å™¨     â”‚  â”‚   é¡¹ç›®ç®¡ç†å™¨     â”‚  â”‚   æ–‡ä»¶ç®¡ç†å™¨     â”‚ â”‚
â”‚  â”‚data_processor.pyâ”‚  â”‚project_manager  â”‚  â”‚ file_manager.py â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®è®¿é—®å±‚ (Data Access Layer)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æ•°æ®åº“æ¨¡å‹     â”‚  â”‚   å®ä½“æ¨¡å‹       â”‚  â”‚   Excelå¤„ç†å™¨    â”‚ â”‚
â”‚  â”‚   database.py   â”‚  â”‚income_record.py â”‚  â”‚ excel_handler.pyâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”§ æ ¸å¿ƒæŠ€æœ¯æ ˆ

#### å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯                    | ç‰ˆæœ¬    | ç”¨é€”     | ä¼˜åŠ¿                   |
| ----------------------- | ------- | -------- | ---------------------- |
| **CustomTkinter** | 5.2.0+  | GUIæ¡†æ¶  | ç°ä»£åŒ–å¤–è§‚ï¼Œå“åº”å¼è®¾è®¡ |
| **Tkinter**       | å†…ç½®    | åŸºç¡€GUI  | è·¨å¹³å°å…¼å®¹æ€§å¥½         |
| **Pillow**        | 10.0.0+ | å›¾åƒå¤„ç† | ä¸°å¯Œçš„å›¾åƒæ ¼å¼æ”¯æŒ     |

#### æ•°æ®å¤„ç†

| æŠ€æœ¯               | ç‰ˆæœ¬   | ç”¨é€”      | ä¼˜åŠ¿                |
| ------------------ | ------ | --------- | ------------------- |
| **Pandas**   | 2.0.0+ | æ•°æ®åˆ†æ  | é«˜æ€§èƒ½æ•°æ®å¤„ç†      |
| **OpenPyXL** | 3.1.0+ | Excelæ“ä½œ | å®Œæ•´çš„ExcelåŠŸèƒ½æ”¯æŒ |
| **xlrd**     | 2.0.1+ | Excelè¯»å– | å…¼å®¹æ—§ç‰ˆExcelæ ¼å¼   |

#### ç³»ç»Ÿæ”¯æŒ

| æŠ€æœ¯              | ç‰ˆæœ¬ | ç”¨é€”       | ä¼˜åŠ¿               |
| ----------------- | ---- | ---------- | ------------------ |
| **Python**  | 3.7+ | è¿è¡Œç¯å¢ƒ   | è·¨å¹³å°ï¼Œä¸°å¯Œçš„ç”Ÿæ€ |
| **Pickle**  | å†…ç½® | æ•°æ®åºåˆ—åŒ– | é«˜æ•ˆçš„å¯¹è±¡æŒä¹…åŒ–   |
| **pathlib** | å†…ç½® | è·¯å¾„æ“ä½œ   | ç°ä»£åŒ–çš„è·¯å¾„å¤„ç†   |

### é¡¹ç›®ç»“æ„

```
æ”¶å…¥è¯æ®ç®¡ç†ç¨‹åº/
â”œâ”€â”€ main.py                 # ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt        # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”œâ”€â”€ config.py          # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ gui/               # GUIç•Œé¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ main_window.py         # ä¸»çª—å£
â”‚   â”‚   â”œâ”€â”€ project_launcher.py    # é¡¹ç›®å¯åŠ¨å™¨
â”‚   â”‚   â”œâ”€â”€ record_dialog.py       # è®°å½•ç¼–è¾‘å¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ attachment_dialog.py   # é™„ä»¶ç®¡ç†å¯¹è¯æ¡†
â”‚   â”‚   â””â”€â”€ ...                    # å…¶ä»–GUIç»„ä»¶
â”‚   â”œâ”€â”€ data/              # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ data_processor.py      # æ•°æ®å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ excel_handler.py       # Excelå¤„ç†
â”‚   â”‚   â”œâ”€â”€ file_manager.py        # æ–‡ä»¶ç®¡ç†
â”‚   â”‚   â””â”€â”€ project_manager.py     # é¡¹ç›®ç®¡ç†
â”‚   â””â”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚       â”œâ”€â”€ database.py            # æ•°æ®åº“æ¨¡å‹
â”‚       â”œâ”€â”€ income_record.py       # æ”¶å…¥è®°å½•æ¨¡å‹
â”‚       â””â”€â”€ attachment.py          # é™„ä»¶æ¨¡å‹
â””â”€â”€ data/                  # æ•°æ®ç›®å½•ï¼ˆè¢«gitignoreå¿½ç•¥ï¼‰
    â”œâ”€â”€ app.log           # åº”ç”¨æ—¥å¿—
    â”œâ”€â”€ database.pkl      # æ•°æ®åº“æ–‡ä»¶
    â””â”€â”€ attachments/      # é™„ä»¶å­˜å‚¨
```

### æŠ€æœ¯æ ˆ

- **GUIæ¡†æ¶**ï¼š[CustomTkinter](https://github.com/TomSchimansky/CustomTkinter) - ç°ä»£åŒ–çš„Tkinterç•Œé¢åº“
- **æ•°æ®å¤„ç†**ï¼š[Pandas](https://pandas.pydata.org/) - æ•°æ®åˆ†æå’Œå¤„ç†
- **Excelæ“ä½œ**ï¼š[OpenPyXL](https://openpyxl.readthedocs.io/) - Excelæ–‡ä»¶è¯»å†™
- **å›¾åƒå¤„ç†**ï¼š[Pillow](https://pillow.readthedocs.io/) - å›¾åƒå¤„ç†åº“
- **æ•°æ®æŒä¹…åŒ–**ï¼šPython Pickle - å¯¹è±¡åºåˆ—åŒ–

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### æ•°æ®æ¨¡å‹ (models/)

- `database.py`: æ•°æ®åº“æ“ä½œå’Œç®¡ç†
- `income_record.py`: æ”¶å…¥è®°å½•æ•°æ®ç»“æ„
- `attachment.py`: é™„ä»¶ä¿¡æ¯æ•°æ®ç»“æ„

#### æ•°æ®å¤„ç† (data/)

- `data_processor.py`: æ ¸å¿ƒæ•°æ®å¤„ç†é€»è¾‘
- `excel_handler.py`: Excelæ–‡ä»¶å¯¼å…¥å¯¼å‡º
- `file_manager.py`: æ–‡ä»¶å’Œé™„ä»¶ç®¡ç†
- `project_manager.py`: é¡¹ç›®ç®¡ç†åŠŸèƒ½

#### ç”¨æˆ·ç•Œé¢ (gui/)

- `main_window.py`: ä¸»ç•Œé¢å’Œæ ¸å¿ƒäº¤äº’
- `project_launcher.py`: é¡¹ç›®é€‰æ‹©å’Œåˆ›å»º
- `record_dialog.py`: è®°å½•ç¼–è¾‘ç•Œé¢
- `attachment_dialog.py`: é™„ä»¶ç®¡ç†ç•Œé¢

### å¼€å‘ç¯å¢ƒé…ç½®

1. **å®‰è£…å¼€å‘ä¾èµ–**

   ```bash
   pip install -r requirements.txt
   pip install pytest  # æµ‹è¯•æ¡†æ¶ï¼ˆå¯é€‰ï¼‰
   ```
2. **ä»£ç è§„èŒƒ**

   - éµå¾ª PEP 8 Pythonç¼–ç è§„èŒƒ
   - ä½¿ç”¨ç±»å‹æ³¨è§£æé«˜ä»£ç å¯è¯»æ€§
   - æ¨¡å—åŒ–è®¾è®¡ï¼Œå•ä¸€èŒè´£åŸåˆ™
3. **è°ƒè¯•æ¨¡å¼**

   - ä¿®æ”¹ `src/config.py` ä¸­çš„æ—¥å¿—çº§åˆ«ä¸º `DEBUG`
   - æŸ¥çœ‹ `data/app.log` è·å–è¯¦ç»†æ—¥å¿—ä¿¡æ¯

### æ‰©å±•å¼€å‘

#### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ç›¸åº”æ¨¡å—ä¸­æ·»åŠ åŠŸèƒ½å‡½æ•°
2. æ›´æ–°æ•°æ®æ¨¡å‹ï¼ˆå¦‚éœ€è¦ï¼‰
3. åˆ›å»ºæˆ–ä¿®æ”¹GUIç•Œé¢
4. æ›´æ–°é…ç½®æ–‡ä»¶
5. æ·»åŠ ç›¸åº”çš„é”™è¯¯å¤„ç†

#### è‡ªå®šä¹‰é…ç½®

- ä¿®æ”¹ `src/config.py` ä¸­çš„é…ç½®é¡¹
- é‡å¯ç¨‹åºä½¿é…ç½®ç”Ÿæ•ˆ

### ğŸ¨ UIç»„ä»¶æ¶æ„

```python
# GUIç»„ä»¶å±‚æ¬¡ç»“æ„
MainWindow (CTk)
â”œâ”€â”€ HeaderFrame (CTkFrame)
â”‚   â”œâ”€â”€ ToolbarFrame (CTkFrame)
â”‚   â”‚   â”œâ”€â”€ ImportButton (CTkButton)
â”‚   â”‚   â”œâ”€â”€ ExportButton (CTkButton)
â”‚   â”‚   â””â”€â”€ SettingsButton (CTkButton)
â”‚   â””â”€â”€ FilterFrame (CTkFrame)
â”‚       â”œâ”€â”€ SearchEntry (CTkEntry)
â”‚       â””â”€â”€ FilterComboBox (CTkComboBox)
â”œâ”€â”€ ContentFrame (CTkFrame)
â”‚   â”œâ”€â”€ SidebarFrame (CTkFrame)
â”‚   â”‚   â”œâ”€â”€ StatisticsPanel (CTkFrame)
â”‚   â”‚   â””â”€â”€ FilterPanel (CTkFrame)
â”‚   â””â”€â”€ MainPanel (CTkFrame)
â”‚       â”œâ”€â”€ DataTable (CTkScrollableFrame)
â”‚       â””â”€â”€ PaginationFrame (CTkFrame)
â””â”€â”€ StatusFrame (CTkFrame)
    â”œâ”€â”€ StatusLabel (CTkLabel)
    â””â”€â”€ ProgressBar (CTkProgressBar)
```

### ğŸ“Š æ•°æ®æµæ¶æ„

```mermaid
graph TD
    A[Excelæ–‡ä»¶] --> B[ExcelHandler]
    B --> C[DataProcessor]
    C --> D[Database]
    D --> E[IncomeRecord]
    E --> F[MainWindow]
    F --> G[ç”¨æˆ·ç•Œé¢]
  
    H[é™„ä»¶æ–‡ä»¶] --> I[FileManager]
    I --> J[Attachment]
    J --> D
  
    K[ç”¨æˆ·æ“ä½œ] --> F
    F --> L[äº‹ä»¶å¤„ç†å™¨]
    L --> C
```

## ğŸ”§ éƒ¨ç½²æŒ‡å—

### ğŸ“¦ æ‰“åŒ…å‘å¸ƒ

#### ä½¿ç”¨ PyInstaller åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶

1. **å®‰è£…æ‰“åŒ…å·¥å…·**

   ```bash
   pip install pyinstaller
   ```
2. **åˆ›å»ºspecæ–‡ä»¶** (`income_manager.spec`)

   ```python
   # -*- mode: python ; coding: utf-8 -*-

   block_cipher = None

   a = Analysis(
       ['main.py'],
       pathex=[],
       binaries=[],
       datas=[
           ('src/assets/*', 'assets/'),
           ('src/config.py', 'src/'),
       ],
       hiddenimports=[
           'customtkinter',
           'pandas',
           'openpyxl',
           'PIL'
       ],
       hookspath=[],
       hooksconfig={},
       runtime_hooks=[],
       excludes=[],
       win_no_prefer_redirects=False,
       win_private_assemblies=False,
       cipher=block_cipher,
       noarchive=False,
   )

   pyd = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

   exe = EXE(
       pyd,
       a.scripts,
       [],
       exclude_binaries=True,
       name='æ”¶å…¥è¯æ®ç®¡ç†ç¨‹åº',
       debug=False,
       bootloader_ignore_signals=False,
       strip=False,
       upx=True,
       console=False,
       disable_windowed_traceback=False,
       argv_emulation=False,
       target_arch=None,
       codesign_identity=None,
       entitlements_file=None,
   )

   coll = COLLECT(
       exe,
       a.binaries,
       a.zipfiles,
       a.datas,
       strip=False,
       upx=True,
       upx_exclude=[],
       name='income_manager'
   )
   ```
3. **æ‰§è¡Œæ‰“åŒ…å‘½ä»¤**

   ```bash
   pyinstaller income_manager.spec
   ```

## â“ å¸¸è§é—®é¢˜

### ğŸ”§ å®‰è£…ä¸ç¯å¢ƒé—®é¢˜

#### Q: å®‰è£…ä¾èµ–æ—¶å‡ºç°é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**ç—‡çŠ¶**ï¼š`pip install` å‘½ä»¤æ‰§è¡Œå¤±è´¥æˆ–ä¾èµ–åŒ…å®‰è£…ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. å‡çº§pipåˆ°æœ€æ–°ç‰ˆæœ¬
python -m pip install --upgrade pip

# 2. ä½¿ç”¨å›½å†…é•œåƒæºï¼ˆæ¨èï¼‰
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 3. å¦‚æœä»æœ‰é—®é¢˜ï¼Œå°è¯•é€ä¸ªå®‰è£…
pip install customtkinter>=5.2.0
pip install pandas>=2.0.0
pip install openpyxl>=3.1.0

# 4. æ£€æŸ¥Pythonç‰ˆæœ¬å…¼å®¹æ€§
python --version  # åº”ä¸º3.7+
```

#### Q: ç¨‹åºæ— æ³•å¯åŠ¨ï¼Œæ˜¾ç¤ºModuleNotFoundErrorï¼Ÿ

**ç—‡çŠ¶**ï¼šå‡ºç°ç±»ä¼¼ `ModuleNotFoundError: No module named 'customtkinter'` çš„é”™è¯¯

**æ’æŸ¥æ­¥éª¤**ï¼š

1. **æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ**ï¼š

   ```bash
   # ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
   .venv\Scripts\activate
   ```
2. **éªŒè¯ä¾èµ–å®‰è£…**ï¼š

   ```bash
   # æ£€æŸ¥å·²å®‰è£…çš„åŒ…
   pip list

   # é‡æ–°å®‰è£…ä¾èµ–
   pip install -r requirements.txt --force-reinstall
   ```
3. **æ£€æŸ¥Pythonè·¯å¾„**ï¼š

   ```bash
   python -c "import sys; print(sys.path)"
   ```

#### Q: Windowsç³»ç»Ÿä¸Šå‡ºç°ç¼–ç é”™è¯¯ï¼Ÿ

**ç—‡çŠ¶**ï¼šæ˜¾ç¤ºä¸­æ–‡å­—ç¬¦ä¹±ç æˆ–ç¼–ç ç›¸å…³é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡
set PYTHONIOENCODING=utf-8

# æˆ–åœ¨PowerShellä¸­
$env:PYTHONIOENCODING="utf-8"
python main.py
```

### ğŸ“Š æ•°æ®å¯¼å…¥é—®é¢˜

#### Q: Excelå¯¼å…¥å¤±è´¥ï¼Œæç¤ºæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Ÿ

**å¸¸è§åŸå› ä¸è§£å†³æ–¹æ¡ˆ**ï¼š

| é—®é¢˜       | åŸå›                       | è§£å†³æ–¹æ¡ˆ                |
| ---------- | ------------------------- | ----------------------- |
| æ–‡ä»¶è¢«å ç”¨ | Excelæ–‡ä»¶åœ¨å…¶ä»–ç¨‹åºä¸­æ‰“å¼€ | å…³é—­æ‰€æœ‰Excelç¨‹åºåé‡è¯• |
| æ ¼å¼ä¸æ”¯æŒ | æ–‡ä»¶ä¸º.csvæˆ–å…¶ä»–æ ¼å¼      | è½¬æ¢ä¸º.xlsxæˆ–.xlsæ ¼å¼   |
| æ–‡ä»¶æŸå   | Excelæ–‡ä»¶ç»“æ„æŸå         | å°è¯•ä¿®å¤æ–‡ä»¶æˆ–é‡æ–°åˆ›å»º  |
| æƒé™ä¸è¶³   | æ–‡ä»¶ä¸ºåªè¯»æˆ–æƒé™å—é™      | æ£€æŸ¥æ–‡ä»¶æƒé™è®¾ç½®        |

#### Q: å¯¼å…¥çš„æ•°æ®æ˜¾ç¤ºä¸å®Œæ•´æˆ–é”™è¯¯ï¼Ÿ

**æ’æŸ¥æ¸…å•**ï¼š

- [ ] æ£€æŸ¥Excelæ–‡ä»¶ä¸­çš„å¿…è¦åˆ—æ˜¯å¦å­˜åœ¨
- [ ] ç¡®è®¤æ•°æ®æ ¼å¼ç¬¦åˆè¦æ±‚ï¼ˆæ•°å­—åˆ—ä¸å«æ–‡æœ¬ï¼‰
- [ ] éªŒè¯åˆåŒå·çš„å”¯ä¸€æ€§
- [ ] æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†æ­£ç¡®çš„å·¥ä½œè¡¨

**æ•°æ®éªŒè¯è„šæœ¬**ï¼š

```python
import pandas as pd

# éªŒè¯Excelæ–‡ä»¶ç»“æ„
def validate_excel(file_path):
    try:
        df = pd.read_excel(file_path)
        required_columns = ['åˆåŒå·', 'å®¢æˆ·å', 'æœ¬å¹´ç¡®è®¤çš„æ”¶å…¥']
  
        missing_columns = [col for col in required_columns if col not in df.columns]
        if missing_columns:
            print(f"ç¼ºå°‘å¿…è¦åˆ—: {missing_columns}")
  
        # æ£€æŸ¥é‡å¤åˆåŒå·
        duplicates = df[df['åˆåŒå·'].duplicated()]
        if not duplicates.empty:
            print(f"å‘ç°é‡å¤åˆåŒå·: {duplicates['åˆåŒå·'].tolist()}")
  
    except Exception as e:
        print(f"æ–‡ä»¶éªŒè¯å¤±è´¥: {e}")
```

### ğŸ“ é™„ä»¶ç®¡ç†é—®é¢˜

#### Q: é™„ä»¶ä¸Šä¼ å¤±è´¥æˆ–é™„ä»¶ä¸¢å¤±ï¼Ÿ

**é—®é¢˜è¯Šæ–­**ï¼š

```bash
# æ£€æŸ¥é™„ä»¶ç›®å½•æƒé™
dir data\attachments /Q

# æ£€æŸ¥ç£ç›˜ç©ºé—´
fsutil volume diskfree C:

# éªŒè¯æ–‡ä»¶è·¯å¾„
python -c "from pathlib import Path; print(Path('data/attachments').absolute())"
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **æƒé™é—®é¢˜**ï¼šä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åº
2. **ç©ºé—´ä¸è¶³**ï¼šæ¸…ç†ç£ç›˜ç©ºé—´æˆ–æ›´æ”¹å­˜å‚¨ä½ç½®
3. **è·¯å¾„é—®é¢˜**ï¼šé¿å…ä½¿ç”¨åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„è·¯å¾„

#### Q: é™„ä»¶æ–‡ä»¶å¤¹æ— æ³•æ‰“å¼€ï¼Ÿ

**å¯èƒ½åŸå› **ï¼š

- æ–‡ä»¶å¤¹è·¯å¾„åŒ…å«ç‰¹æ®Šå­—ç¬¦
- ç³»ç»Ÿæ–‡ä»¶å…³è”è®¾ç½®é—®é¢˜
- å®‰å…¨è½¯ä»¶é˜»æ­¢

**è§£å†³æ–¹æ¡ˆ**ï¼š

```python
# æ‰‹åŠ¨æ‰“å¼€é™„ä»¶æ–‡ä»¶å¤¹
import os
import subprocess

def open_folder(path):
    try:
        subprocess.run(['explorer', path], check=True)
    except Exception as e:
        print(f"æ— æ³•æ‰“å¼€æ–‡ä»¶å¤¹: {e}")
        # å¤‡é€‰æ–¹æ¡ˆ
        os.startfile(path)
```

### ğŸš€ æ€§èƒ½ä¼˜åŒ–é—®é¢˜

#### Q: ç¨‹åºè¿è¡Œç¼“æ…¢ï¼Œç•Œé¢å¡é¡¿ï¼Ÿ

**æ€§èƒ½åˆ†æå·¥å…·**ï¼š

```bash
# å®‰è£…æ€§èƒ½åˆ†æå·¥å…·
pip install memory-profiler psutil

# è¿è¡Œæ€§èƒ½åˆ†æ
python -m memory_profiler main.py
```

**ä¼˜åŒ–å»ºè®®**ï¼š

1. **æ•°æ®é‡ä¼˜åŒ–**ï¼š

   - ä½¿ç”¨ç­›é€‰åŠŸèƒ½å‡å°‘æ˜¾ç¤ºæ•°æ®
   - å¯ç”¨åˆ†é¡µæ˜¾ç¤ºï¼ˆæ¯é¡µ1000æ¡è®°å½•ï¼‰
   - å®šæœŸæ¸…ç†å†å²æ•°æ®
2. **ç³»ç»Ÿèµ„æºä¼˜åŒ–**ï¼š

   ```bash
   # æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨
   tasklist /fi "imagename eq python.exe"

   # ä¼˜åŒ–è™šæ‹Ÿå†…å­˜è®¾ç½®
   # æ§åˆ¶é¢æ¿ > ç³»ç»Ÿ > é«˜çº§ç³»ç»Ÿè®¾ç½® > æ€§èƒ½è®¾ç½®
   ```
3. **ç¨‹åºé…ç½®ä¼˜åŒ–**ï¼š

   ```python
   # åœ¨ config.py ä¸­è°ƒæ•´æ€§èƒ½å‚æ•°
   PERFORMANCE_CONFIG = {
       "max_display_rows": 1000,
       "auto_save_interval": 300,  # 5åˆ†é’Ÿ
       "enable_lazy_loading": True,
       "cache_size_mb": 128
   }
   ```

### ğŸ” æ—¥å¿—åˆ†æä¸æ•…éšœæ’é™¤

#### æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
type data\app.log | more

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯
findstr /i "error" data\app.log

# å®æ—¶ç›‘æ§æ—¥å¿—
Get-Content data\app.log -Wait -Tail 10
```

#### å¸¸è§é”™è¯¯ä»£ç 

| é”™è¯¯ä»£ç  | å«ä¹‰              | è§£å†³æ–¹æ¡ˆ           |
| -------- | ----------------- | ------------------ |
| E001     | æ•°æ®åº“æ–‡ä»¶æŸå    | ä»å¤‡ä»½æ¢å¤æ•°æ®     |
| E002     | Excelæ–‡ä»¶æ ¼å¼é”™è¯¯ | æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œç»“æ„ |
| E003     | æƒé™ä¸è¶³          | ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ   |
| E004     | ç£ç›˜ç©ºé—´ä¸è¶³      | æ¸…ç†ç£ç›˜ç©ºé—´       |
| E005     | ç½‘ç»œè¿æ¥é—®é¢˜      | æ£€æŸ¥ç½‘ç»œè®¾ç½®       |

## ğŸ“„ è®¸å¯è¯ä¸ç‰ˆæƒ

### å¼€æºè®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **MIT è®¸å¯è¯**ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

```
MIT License

Copyright (c) 2024 æ”¶å…¥è¯æ®ç®¡ç†ç¨‹åºå¼€å‘å›¢é˜Ÿ

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

### ç¬¬ä¸‰æ–¹ç»„ä»¶è®¸å¯

| ç»„ä»¶          | è®¸å¯è¯       | é“¾æ¥                                                  |
| ------------- | ------------ | ----------------------------------------------------- |
| CustomTkinter | MIT          | [GitHub](https://github.com/TomSchimansky/CustomTkinter) |
| Pandas        | BSD-3-Clause | [å®˜ç½‘](https://pandas.pydata.org)                        |
| OpenPyXL      | MIT          | [å®˜ç½‘](https://openpyxl.readthedocs.io)                  |

## ğŸ¤ ç¤¾åŒºè´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼æ— è®ºæ˜¯ä»£ç æ”¹è¿›ã€æ–‡æ¡£å®Œå–„ã€bugæŠ¥å‘Šè¿˜æ˜¯åŠŸèƒ½å»ºè®®ã€‚

### ğŸ”§ å¼€å‘è´¡çŒ®

#### ä»£ç è´¡çŒ®æµç¨‹

1. **Forké¡¹ç›®** - ç‚¹å‡»å³ä¸Šè§’çš„ForkæŒ‰é’®
2. **å…‹éš†åˆ°æœ¬åœ°**
   ```bash
   git clone https://github.com/your-username/income-evidence-manager.git
   cd income-evidence-manager
   ```
3. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feature/your-feature-name
   ```
4. **å¼€å‘å’Œæµ‹è¯•**
   ```bash
   # å®‰è£…å¼€å‘ä¾èµ–
   pip install -r requirements-dev.txt

   # è¿è¡Œæµ‹è¯•
   python -m pytest tests/

   # ä»£ç æ ¼å¼æ£€æŸ¥
   black src/
   flake8 src/
   ```
5. **æäº¤æ›´æ”¹**
   ```bash
   git add .
   git commit -m "Add: ç®€æ´æè¿°ä½ çš„æ›´æ”¹"
   ```
6. **æ¨é€åˆ†æ”¯**
   ```bash
   git push origin feature/your-feature-name
   ```
7. **åˆ›å»ºPull Request**

#### ä»£ç è§„èŒƒ

- **PEP 8**: éµå¾ªPythonç¼–ç è§„èŒƒ
- **ç±»å‹æ³¨è§£**: æ–°ä»£ç å¿…é¡»åŒ…å«ç±»å‹æ³¨è§£
- **æ–‡æ¡£å­—ç¬¦ä¸²**: æ‰€æœ‰å…¬å…±å‡½æ•°éœ€è¦è¯¦ç»†çš„docstring
- **æµ‹è¯•è¦†ç›–**: æ–°åŠŸèƒ½éœ€è¦ç›¸åº”çš„å•å…ƒæµ‹è¯•

#### æäº¤ä¿¡æ¯è§„èŒƒ

```
ç±»å‹: ç®€çŸ­æè¿°

è¯¦ç»†æè¿°ï¼ˆå¯é€‰ï¼‰

ç±»å‹ï¼š
- Add: æ–°å¢åŠŸèƒ½
- Fix: ä¿®å¤bug
- Update: æ›´æ–°ç°æœ‰åŠŸèƒ½
- Refactor: ä»£ç é‡æ„
- Docs: æ–‡æ¡£æ›´æ–°
- Test: æµ‹è¯•ç›¸å…³
```

### ğŸ“ æ–‡æ¡£è´¡çŒ®

- **ç”¨æˆ·æ–‡æ¡£**: æ”¹è¿›ä½¿ç”¨è¯´æ˜å’Œæ•™ç¨‹
- **å¼€å‘æ–‡æ¡£**: å®Œå–„APIæ–‡æ¡£å’Œæ¶æ„è¯´æ˜
- **ç¿»è¯‘**: æä¾›å¤šè¯­è¨€æ”¯æŒ
- **ç¤ºä¾‹**: æ·»åŠ æ›´å¤šä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ

### ğŸ› é—®é¢˜æŠ¥å‘Š

#### åˆ›å»ºé«˜è´¨é‡çš„Issue

1. **æœç´¢å·²æœ‰é—®é¢˜**: é¿å…é‡å¤æŠ¥å‘Š
2. **ä½¿ç”¨é—®é¢˜æ¨¡æ¿**: æä¾›å®Œæ•´çš„é—®é¢˜æè¿°
3. **æä¾›ç¯å¢ƒä¿¡æ¯**:
   - æ“ä½œç³»ç»Ÿç‰ˆæœ¬
   - Pythonç‰ˆæœ¬
   - ä¾èµ–åŒ…ç‰ˆæœ¬
   - é”™è¯¯æ—¥å¿—

#### BugæŠ¥å‘Šæ¨¡æ¿

```markdown
## Bugæè¿°
ç®€æ´æ¸…æ™°åœ°æè¿°bug

## é‡ç°æ­¥éª¤
1. æ‰§è¡Œæ“ä½œA
2. ç‚¹å‡»æŒ‰é’®B
3. å‡ºç°é”™è¯¯C

## é¢„æœŸè¡Œä¸º
æè¿°ä½ æœŸæœ›å‘ç”Ÿçš„æ­£ç¡®è¡Œä¸º

## å®é™…è¡Œä¸º
æè¿°å®é™…è§‚å¯Ÿåˆ°çš„é”™è¯¯è¡Œä¸º

## ç¯å¢ƒä¿¡æ¯
- OS: Windows 11
- Python: 3.9.7
- ç¨‹åºç‰ˆæœ¬: 1.0.0

## é™„åŠ ä¿¡æ¯
- é”™è¯¯æ—¥å¿—
- æˆªå›¾
- ç›¸å…³æ–‡ä»¶
```

### ğŸ’¡ åŠŸèƒ½å»ºè®®

æˆ‘ä»¬æ¬¢è¿æ–°åŠŸèƒ½çš„å»ºè®®ï¼è¯·åœ¨æäº¤å‰è€ƒè™‘ï¼š

- åŠŸèƒ½çš„å®ç”¨æ€§å’Œéœ€æ±‚ç¨‹åº¦
- ä¸ç°æœ‰æ¶æ„çš„å…¼å®¹æ€§
- å®ç°çš„å¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

<div align="center">

![GitHub stars](https://img.shields.io/github/stars/your-username/income-evidence-manager?style=social)
![GitHub forks](https://img.shields.io/github/forks/your-username/income-evidence-manager?style=social)
![GitHub issues](https://img.shields.io/github/issues/your-username/income-evidence-manager)
![GitHub pull requests](https://img.shields.io/github/issues-pr/your-username/income-evidence-manager)

</div>

## ğŸ† è´¡çŒ®è€…

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

<div align="center">
<a href="https://github.com/your-username/income-evidence-manager/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=your-username/income-evidence-manager" />
</a>
</div>

## ğŸŒŸ æ”¯æŒé¡¹ç›®

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ï¼š

- â­ **Star** è¿™ä¸ªä»“åº“
- ğŸ´ **Fork** å¹¶è´¡çŒ®ä»£ç 
- ğŸ“¢ **åˆ†äº«** ç»™å…¶ä»–éœ€è¦çš„äºº
- â˜• [**èµåŠ©å¼€å‘**](https://github.com/sponsors/your-username)

## ğŸ“ è”ç³»æˆ‘

- ğŸ“§ **é‚®ç®±**:wkenny@126.com

### ç¤¾äº¤åª’ä½“

- ğŸ“ ä¸»é¡µ: [Kennyçš„å®¡è®¡ä¸–ç•Œ](http://www.kennycpa.top)

---

<div align="center">

**è®©è´¢åŠ¡æ•°æ®ç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆ**

[![Made with â¤ï¸ in China](https://img.shields.io/badge/Made%20with%20â¤ï¸%20in-China-red.svg)](https://github.com/your-username/income-evidence-manager)

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­

è¿™æ˜¯å¯¹æˆ‘ä»¬æœ€å¤§çš„é¼“åŠ±å’Œæ”¯æŒï¼

</div>
